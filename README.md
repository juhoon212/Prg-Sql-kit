# Programmers SQL KIT

프로그래머스 sql 고득점 kit 문제풀이용 레포지토리입니다. 



![스크린샷 2023-05-07 오후 4 40 29](https://user-images.githubusercontent.com/121741140/236664521-013667c4-f489-416f-86a2-0c0e1ef1d7ed.png)
- 2023년 5월 7일 시작

## SELECT

### 3월에 태어난 여성 회원 목록 출력하기

```
SELECT
    member_id,
    member_name,
    gender,
    to_char(DATE_OF_BIRTH, 'YYYY-MM-DD')as date_of_birth
from
    member_profile
WHERE
    TO_CHAR(DATE_OF_BIRTH, 'MM') = '03' and
    tlno is not null AND GENDER = 'W'
order by
    member_id asc
 ```

### 모든 레코드 조회하기

```
SELECT *
FROM ANIMAL_INS
ORDER BY ANIMAL_ID
```
### 12세 이하인 여자 환자 목록 출력하기

```
SELECT PT_NAME, PT_NO, GEND_CD, AGE , NVL(TLNO, 'NONE')
FROM PATIENT
WHERE AGE <= 12 AND GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME;
```

### 과일로 만든 아이스크림 고르기

```
SELECT F.FLAVOR 
FROM FIRST_HALF F JOIN ICECREAM_INFO I ON F.FLAVOR = I.FLAVOR
WHERE I.INGREDIENT_TYPE = 'fruit_based' AND
F.TOTAL_ORDER > 3000
ORDER BY F.TOTAL_ORDER DESC;
```

### 재구매가 일어난 상품과 회원 리스트 구하기
```
SELECT USER_ID, PRODUCT_ID
FROM (
    SELECT USER_ID, PRODUCT_ID, COUNT(*) C
      FROM ONLINE_SALE
      GROUP BY USER_ID , PRODUCT_ID) OS
WHERE C > 1
ORDER BY USER_ID, PRODUCT_ID DESC;
```

### 서울에 위치한 식당 목록 출력하기

```
SELECT RI.REST_ID,
       RI.REST_NAME,
       RI.FOOD_TYPE,
       RI.FAVORITES,
       RI.ADDRESS,
       ROUND(AVG(REVIEW_SCORE),2) AS AVG_REVIEW
FROM REST_INFO RI JOIN REST_REVIEW RR ON RI.REST_ID = RR.REST_ID
WHERE RI.ADDRESS LIKE '서울%'
GROUP BY RI.REST_ID, RI.REST_NAME, RI.FOOD_TYPE, RI.FAVORITES, RI.ADDRESS
ORDER BY AVG_REVIEW DESC, RI.FAVORITES DESC; 
```

### 조건에 부합하는 중고거래 댓글 조회하기

```
SELECT UGB.TITLE,
        UGB.BOARD_ID,
        UGR.REPLY_ID,
        UGR.WRITER_ID,
        UGR.CONTENTS,
        TO_CHAR(UGR.CREATED_DATE,'YYYY-MM-DD') AS C_DATE
FROM USED_GOODS_BOARD UGB JOIN USED_GOODS_REPLY UGR ON UGB.BOARD_ID = UGR.BOARD_ID
WHERE TO_CHAR(UGB.CREATED_DATE, 'YYYY-MM') = '2022-10'
ORDER BY C_DATE, UGB.TITLE; // 일반 조인은 메인이 되는 왼쪽 테이블 기준으로 조인된다
```

### 강원도에 위치한 생산공장 목록 출력하기

```
SELECT FACTORY_ID, FACTORY_NAME, ADDRESS
FROM FOOD_FACTORY
WHERE ADDRESS LIKE '강원도%'
```

### 인기있는 아이스크림

```
SELECT FLAVOR
FROM FIRST_HALF
ORDER BY TOTAL_ORDER DESC , SHIPMENT_ID
```

## Join


### 조건에 맞는 도서와 저자 리스트 출력하기

```
SELECT B.BOOK_ID, A.AUTHOR_NAME, TO_CHAR(B.PUBLISHED_DATE, 'YYYY-MM-DD') PD
FROM BOOK B JOIN AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID
WHERE CATEGORY = '경제'
ORDER BY PD;
```

### 상품 별 오프라인 매출 구하기

```
SELECT P.PRODUCT_CODE, SUM(P.PRICE * OS.SALES_AMOUNT) AS SALES
FROM PRODUCT P JOIN OFFLINE_SALE OS ON P.PRODUCT_ID = OS.PRODUCT_ID
GROUP BY P.PRODUCT_CODE
ORDER BY SALES DESC, PRODUCT_CODE
```

### 있었는데요 없었습니다

```
SELECT AI.ANIMAL_ID, AI.NAME 
FROM ANIMAL_INS AI JOIN ANIMAL_OUTS AO ON AI.ANIMAL_ID = AO.ANIMAL_ID
WHERE AI.DATETIME > AO.DATETIME
ORDER BY AI.DATETIME 
```

### 없어진 기록 찾기

- 내 답안

```
SELECT ANIMAL_ID, NAME
FROM ANIMAL_OUTS A
WHERE NOT EXISTS (SELECT ANIMAL_ID FROM ANIMAL_INS B WHERE A.ANIMAL_ID = B.ANIMAL_ID)
ORDER BY ANIMAL_ID
```
- 다른 답안
```
SELECT B.ANIMAL_ID, B.NAME
FROM ANIMAL_INS A RIGHT JOIN ANIMAL_OUTS B ON A.ANIMAL_ID = B.ANIMAL_ID
WHERE A.ANIMAL_ID IS NULL
ORDER BY B.ANIMAL_ID
```

### 오랜 기간 보호한 동물(1) ### 

- 내 답안
```
SELECT NAME, DATETIME
FROM (
    SELECT ROWNUM, AI.NAME, AI.DATETIME
    FROM ANIMAL_INS AI LEFT OUTER JOIN ANIMAL_OUTS AO
                        ON AI.ANIMAL_ID = AO.ANIMAL_ID
    WHERE AO.DATETIME IS NULL
    ORDER BY AI.DATETIME
)
WHERE ROWNUM < 4
```

### 5월 식품들의 총매출 조회하기 ###
```
SELECT FP.PRODUCT_ID, FP.PRODUCT_NAME,
        SUM(FO.AMOUNT * FP.PRICE) TOTAL_SALES
FROM FOOD_PRODUCT FP JOIN FOOD_ORDER FO
                            ON FP.PRODUCT_ID = FO.PRODUCT_ID
WHERE TO_CHAR(PRODUCE_DATE,'YYYY-MM') = '2022-05'
GROUP BY FP.PRODUCT_ID, FP.PRODUCT_NAME
ORDER BY TOTAL_SALES DESC, FP.PRODUCT_ID
```


## Group by


### 자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기

```
SELECT CAR_ID, 
       max(
           case when '2022-10-16' 
           between TO_CHAR(START_DATE, 'YYYY-MM-DD') and TO_CHAR(END_DATE, 'YYYY-MM-DD' )
           then '대여중' 
           else '대여 가능' end) as AVAILABILITY
FROM  CAR_RENTAL_COMPANY_RENTAL_HISTORY 
group by car_id
ORDER BY car_id desc // 다시 
```

### 저자 별 카테고리 별 매출액 집계하기

- ORACLE
```
SELECT B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, SUM(B.PRICE * BS.SALES) TOTAL_SALES
FROM BOOK B JOIN (SELECT * 
                 FROM BOOK_SALES BS
                  WHERE TO_CHAR(BS.SALES_DATE, 'YYYY-MM') = '2022-01'
                 ) BS ON B.BOOK_ID = BS.BOOK_ID JOIN AUTHOR A 
                                                ON A.AUTHOR_ID = B.AUTHOR_ID
GROUP BY B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY
ORDER BY B.AUTHOR_ID, B.CATEGORY DESC
```
- MYSQL

```
SELECT B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, SUM(B.PRICE * BS.SALES) TOTAL_SALES
FROM BOOK B JOIN (SELECT * 
                 FROM BOOK_SALES BS
                  WHERE YEAR(BS.SALES_DATE) = 2022 AND MONTH(BS.SALES_DATE) = 01
                 ) BS ON B.BOOK_ID = BS.BOOK_ID JOIN AUTHOR A 
                                                ON A.AUTHOR_ID = B.AUTHOR_ID
GROUP BY B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY
ORDER BY B.AUTHOR_ID, B.CATEGORY DESC
```

